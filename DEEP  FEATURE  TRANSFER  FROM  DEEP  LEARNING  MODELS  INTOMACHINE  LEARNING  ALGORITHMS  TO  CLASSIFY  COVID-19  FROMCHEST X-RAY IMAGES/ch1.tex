%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{INTRODUCTION}
\label{ch:CH1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Coronaviruses are a family of RNA related viruses causing respiratory diseases in animals and humans. The first known disease caused by this family of viruses was reported in chickens in late 1920s and then coronaviruses in humans was detected in 1960s. This family of viruses was accepted as a new group of viruses and named as coronavirus in 1968 by scientists due to their the distinctive morphological appearance. The first two human coronaviruses discovered were named as coronavirus 229E and coronavirus OC43, respectively \cite{history_coronavirus}. In the following years, different types of coronaviruses in humans have been discovered including SARS-CoV in 2003, HCoV NL63 in 2003, HCoV HKU1 in 2004, MERS-CoV in 2013. Most of these coronaviruses cause serious respiratory infections in humans which may also result in death.

%as a pneumonia outbreak

In December 2019 a novel coronavirus was identified in Wuhan city of China and spread across the country in a short time. Transmission of the virus from human to human was confirmed by the Health Ministry of China in early January 2020 and then the first quarantine was applied by the Chinese Government in late January 2020. On February 2020, the World Health Organization (WHO) officially named this new coronavirus as severe acute respiratory syndrome-related coronavirus, or shortly, SARS-CoV-2. The disease which SARS‑CoV‑2 causes is called as Coronavirus disease 2019 (COVID-19) \cite{coronavirus_species}. On 11 March, 2020,  WHO declared a global pandemic due to the worldwide spread of the COVID-19 \cite{who_pandemic_declaration}.

\textcolor{purple}{As of July 10, 2021, COVID-19 has caused more than 185 million people to be infected and more than 4 million deaths worldwide}, and continues to spread globally \cite{covid19_news}. The most common symptoms of COVID-19 is known as fever, dry cough and tiredness. The loss of taste or smell, diarrhoea, headache, aches and pains, sore throat, and conjunctivitis are also agreed to be strongest symptoms. The infected people may begin to show at least one of these symptoms within an average of 5-6 days; however, this period may take up to 14 days \cite{who_qa}. Since these symptoms are very common to many other diseases as well, it is very important to find highly accurate distinctive methods to detect COVID-19. Furthermore, the demographic information of a patient, i.e., the age and sex information, has a major role on how the patient is affected by COVID-19 \cite{effect_of_demographicInfo}. 

Early and rapid diagnosis, as in all diseases, plays a very important role in the treatment of the COVID-19. For that reason, WHO published protocols on diagnostic detection of COVID-19 on 13 and 17 January, 2020. Polymerase Chain Reaction (PCR) test \cite{pcr_cleveland_clinic} is the most basic method of COVID-19 diagnosis; however, the sensitivity is not high enough for the low viral load. Moreover, laboratory errors may be present in test samples. Because of it, all symptoms, test results, and other available reports must be considered in conjunction in diagnostic process of COVID-19.

COVID-19, as a respiratory disease, also plays a major role in the increase of pneumonia. Therefore, COVID-19 is mostly confused with the diseases having pretty similar symptoms with pneumonia. One way to distinguish them is to examine the most damaged organ, i.e., lungs. Chest X-rays are one of the fastest and the most accessible diagnostic tools to make observations on human lungs. However, detecting and distinguishing COVID-19, pneumonia and similar diseases from chest X-rays may be a difficult task even for expert radiologists \cite{covid_vs_pneumonia}. Therefore, computerized support systems are very much needed to help radiologists to analyze chest X-ray images. 

Thanks to the publicly available high volumes of image data sets, significant progresses have been made in artificial intelligence-based computer vision problems. It has been observed that deep learning algorithms give better results compared to manual diagnosis in problems such as object recognition, perception, and segmentation \cite{success_of_dl}. On the other hand, machine learning has various strong classification algorithms on categorical data including either small or large information. The recent advances in deep learning and machine learning algorithms also open a venue for proposing alternative approaches or developing new algorithms for detection of COVID-19 which can be served as a smart-assistance tool for medical doctors and radiologists whose workload has always been very heavy during the pandemic.

\section{Purpose of Thesis}\label{purposeofthesis}

The scope of this study is two fold: 1) \textcolor{purple}{to show the capability of joint use of deep learning algorithms and machine learning algorithms}, and 2) to apply this knowledge onto an on-going global public health problem. In this sense, we first used deep neural networks with several architectures such as AlexNet, RestNet-18, ResNet-34, Resnet-50, VGG16, and VGG19 for extracting deep features from Covid-19 chest X-rays, and then  
we feeded the deep features coupled with demographic information of patients into machine learning algorithms  such as Support Vector Machines, Logistic Regression, K-Nearest Neighborhoods, and Linear Discriminant Analysis along with their regularized versions (if exists) for  classification Covid-19 status.

%Moreover, the demographic information of patients in thesis dataset is also studied to make conclusions on their effect to machine learning classification algorithms.

\textcolor{purple}{For this purpose, Covid-19 chest X-ray images publicly shared on \texttt{GitHub} platform were used. This dataset consists of samples with non-diseased, virus-induced pneumonia, bacterial-induced pneumonia, fungal-induced pneumonia, and lipoid-induced pneumonia labels, some of which include demographic information. Moreover, samples, whose label includes pneumonia, have detailed causes such as COVID-19, Influenza, Escherichia coli, Aspergillosis spp., etc. To detect COVID-19 over all data by the help of chest X-ray images and demographic information, data cleaning process was applied in two steps: 1) eliminating samples without demographic information, and 2) separating samples into two classes as non-COVID-19 which includes samples not having COVID-19 and COVID-19 which includes samples having COVID-19.}

\textcolor{purple}{By putting the scope mentioned at the beginning of this section into practice, we have provided guidance on preparing a dataset for a study, performing deep learning algorithms with transfer learning, performing machine learning algorithms with different regularization methods, performing deep transfer learning from deep learning to machine learning, using demographic information together with chest X-ray image data, and measuring and comprising the performance of experiments.}


% By applying the stated scope to the mentioned dataset, the main aim of this thesis is to explain how to prepare data for study, how to perform deep learning algorithms, machine learning algorithms and transfer learning from deep learning to machine learning, how to use demographic information together with chest X-ray image data, and to show how demographic information affects and what are the effects of regularization on machine learning algorithms by various performance measures.}

\section{Literature Review}\label{literaturereview}

\textcolor{purple}{With the increase in information and data about COVID-19, artificial intelligence researchers started to work on the diagnosis and classification of this disease. Since the success and effectiveness of machine learning and deep learning, which are sub-branches of artificial intelligence, in the field of classification are known, researchers were able to start working on COVID-19 classification problems without wasting time and quickly reach satisfactory results.}

% With the increasing information on COVID-19 and the formation of data that can be used during this period, artificial intelligence researchers had started to work on this disease. Since both the effectiveness and the limitations of machine learning and deep learning, which are the sub-branches of artificial intelligence, had been already experienced and known by the previous numerous studies, researchers could started new studies without wasting time and achieved satisfying results rapidly.

% Ali Abbasian Ardakani -> 5 kişi
Ardakani et al. \cite{literature_ARDAKANI} worked on chest computed tomography (CT) images to detect whether a person has COVID-19 disease or not. They studied with ten different convolutional neural network (CNN) models, and compared them. The CNN models they compared were AlexNet, VGG-16, VGG-19, SqueezeNet, GoogleNet, MobileNet-V2, ResNet-18, ResNet-50, ResNet-101, and Xception. They achieved the best results with ResNet-101 CNN model with the AUC score of 0.994, the sensitivity of 100\%, the specificity of 99.02\%, the accuracy of 99.51\%, the precision of 99.03\%, and the negative predictive value of 100\%. Moreover, the results of other CNN architectures can be found on the original paper.

% Y. Pathak -> 5 kişi
Pathak et al. \cite{literature_Pathak} used a deep transfer learning technique on CT images to classify non-COVID-19 and COVID-19 people. They used pre-trained ResNet-50 CNN architecture on ImageNet \cite{imagenet} data set to train their classification problem, and 10-fold cross-validation to prevent over-fitting. Then, they obtained the testing accuracy as 93.02\%.

% Tulin Ozturk -> 6 kişi
Ozturk et al. \cite{literature_OZTURK} developed a new CNN architecture, named as DarkCovidNet, to classify chest X-ray images among COVID-19 and no-finding, and among COVID-19, no-findings and pneumonia not caused by COVID-19. They inspired by the DarkNet architecture \cite{yolo_darknet} and constructed theirs by consisting of seventeen convolution layers and one fully-connected layer. The final test result were achieved as the accuracy of 87.02\% for 3-class classification problem, while it was 98.08 for binary classification problem.

% Yujin Oh et al. -> 3 kişi
Oh et al. \cite{literature_oh} solved COVID-19, normal and pneumonia not caused by COVID-19 classification problem with first segmenting the chest X-ray images and yielding extracted lung areas. Then, segmented images were classified patch-by-patch in ResNet-18 CNN architecture base model. For the final decision among patches, the majority voting method was used, and the results were obtained as the accuracy of 88.9\%, the sensitivity of 85.9\%, and the specificity of 96.4\%.

% 2 kişi
Elshennawy and Ibrahim \cite{literature_elshennawy} proposed four different deep learning models to solve a 3-class classification problem. The data set consist of chest X-ray images and the three classes were no finding, bacterial pneumonia, and COVID-19. A CNN model containing 4 convolutional layers and 3 fully-connected layers was proposed and trained from scratch, and the validation loss and accuracy were obtained as 0.3020 and 92.19\% respectively. \textcolor{purple}{A LSTM-CNN model containing one Long short-term memory (LSTM) layer}, 4 convolutional layers and 2 fully-connected layers were developed, and the final results were yielded as the loss of 0.5771 and the accuracy of 91.80\%. Furthermore, two CNN models, ResNet152V2 and MobileNetV2, were used as pre-trained. The test results for ResNet152V2 and MobileNetV2, were achieved as the loss of 0.0523 and the accuracy of 99.22\%, and as the loss of 0.1665 and the accuracy of 96.48\% respectively.

% 3 kişi
Al-falluji et al. \cite{literature_Al-Falluji} were used a modified ResNet-18 CNN model to classify X-ray images among COVID-19, no-findings and pneumonia not caused by COVID-19. The original ResNet-18 architecture was modified as changing the kernel size of conv1 convolution layer from 7 to 3, and adding two new convolution layers after the global average pooling layer. The final test result obtained with this technique was the accuracy of 96.73\%.

% 3 kişi
Nour et al. \cite{A_novelCNNModel} was developed a novel CNN architecture, and solved the 3-class, COVID-19, normal and viral pneumonia other than SARS-CoV-2, based on deep features and Bayesian optimization. The developed CNN architecture includes 5 convolution layers, 3 fully-connected layers and Softmax activation layer at the end. Deep features extracted from fc1 and fc2 layers are used to feed machine learning algorithm, which were support vector machines, decision tree, and k-nearest neighbor, for final classification. The result achieved for features extracted from fc2 were obtained by SVM classifier as the sensitivity of 89.39\%, the specificity of 99.75\%, the F-score of 96.72, and the accuracy of 98.97\%.

The results of the studies mentioned in this section is summarized in the Table~\ref{tab:literature_comparison}.

\begin{landscape}
\begin{table}[]
\centering
\caption{Reviewed works in the literature and their stated results.}
\label{tab:literature_comparison}
\begin{tabular}{lllcccc}
\hline
\multicolumn{1}{c}{\textbf{Authors}}  & \multicolumn{1}{c}{\textbf{Technique}}                                                                                       & \multicolumn{1}{c}{\textbf{Data set}} & \textbf{\begin{tabular}[c]{@{}c@{}}The Number\\  of Classes\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Accuracy \\ (\%)\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Sensitivity\\ (\%)\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Specificity\\ (\%)\end{tabular}} \\ \hline \hline
Ali   Abbasian Ardakani et al. (2020) & ResNet-101 CNN model                                                                                                         & Chest CT images                      & 3                                                                         & 99.51                                                             & 100.00                                                              & 99.02                                                               \\ \hline
Y. Pathak et al. (2020)               & \begin{tabular}[c]{@{}l@{}}Deep transfer learning\\ on ResNet-50 CNN model\end{tabular}                                      & Chest CT images                      & 3                                                                         & 93.02                                                             & 91.46                                                               & 94.78                                                               \\ \hline
Tulin   Ozturk et al. (2020)          & DarkCovidNet CNN model                                                                                                       & Chest X-ray images                   & 3                                                                         & 87.02                                                             & 92.18                                                               & 89.96                                                               \\ \hline
Tulin   Ozturk et al. (2020)          & DarkCovidNet CNN model                                                                                                       & Chest X-ray images                   & 2                                                                         & 98.08                                                             & 95.13                                                               & 95.30                                                               \\ \hline
Yujin Oh et al. (2020)                & \begin{tabular}[c]{@{}l@{}}Patch-by-patch classification\\ in ResNet-18 CNN based\\ model after segmentation\end{tabular}    & Chest X-ray images                   & 2                                                                         & 88.90                                                             & 85.90                                                               & 96.40                                                               \\ \hline
Elshennawy and Ibrahim (2020)         & \begin{tabular}[c]{@{}l@{}}Pre-trained ResNet152V2\\ CNN model\end{tabular}                                                  & Chest X-ray images                   & 2                                                                         & 99.22                                                             & 99.44                                                               & 99.45                                                               \\ \hline
Ruaa Adeeb Al-Falluji et al. (2020)   & \begin{tabular}[c]{@{}l@{}}Deep transfer learning\\ on the modified ResNet-18 \\ CNN model\end{tabular}                      & Chest X-ray images                   & 2                                                                         & 96.73                                                             & 94.00                                                               & 100.00                                                              \\ \hline
Majid   Noue et al. (2020)            & \begin{tabular}[c]{@{}l@{}}SVM classifier fed with deep\\ features obtained from the\\ novel proposed CNN model\end{tabular} & Chest X-ray images                   & 2                                                                         & 98.97                                                             & 89.39                                                               & 99.75                                                               \\ \hline
\end{tabular}
\end{table}
\end{landscape}

\section{Structure}

In Chapter~\ref{ch:CH1}, we presented an overview of the study including the history of COVID-19 disease, the scope and aim of the thesis, and the literature survey on the related works.

This rest of thesis is organized in six chapters. In Chapter~\ref{ch:CH2}, the information about chest X-rays are given.
Chapter~\ref{ch:CH3} introduces the basics of deep learning networks, loss functions, and optimization methods, the basics of convolutional neural networks, transfer learning, and the CNN architectures experimented in this study such as AlexNet, ResNet-18, ResNet-34, ResNet-50, VGG16, and VGG19.

Chapter~\ref{ch:CH4} introduces the basics of machine learning algorithms, cross-validation, the regularization approaches, and the machine learning (ML) algorithms experimented in this study such as support vector machines, logistic regression, k-nearest neighbor and linear discriminant analysis.

In Chapter~\ref{ch:CH5}, all experiments on convolutional neural networks and machine learning algorithms carried out in this study are given together with how the study data set was constructed, data augmentation, deep feature extraction, how the feature matrices were formed, and the methods for hyper-parameter tuning on ML.

In Chapter~\ref{ch:CH6}, results of all the experiments are given together model performance metrics.

Finally, in Chapter~\ref{ch:CH7}, the conclusion of our study is presented with some interpretations and suggestions for further researches.
