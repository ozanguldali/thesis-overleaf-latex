%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{CONCLUSION AND RECOMMENDATION}
\label{ch:CH7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The contribution of this thesis was to understand how to use deep features extracted from convolutional neural network models on machine learning algorithms, and how to combine the image data features with non-image data to use in machine learning algorithms for classification. To do research on this topic, a global health problem COVID-19 disease and chest X-Rays images data along with demographic information were used.

\begin{comment}
The main scope of this thesis was to show an approach on how to use image data without segmenting or manually extracting features to embed them into machine learning algorithms, and afterwards to apply it on a continuing global public health problem.
\end{comment}

Although this study mainly focused on chest X-Rays and image data, one of the aims was to show non-image data can be combined with image data. Our non-image data is the demographic information of patients for corresponding chest X-Rays. Since the data size was not enough for a good classification and the non-image data types was restricted to two features, desired result could not be seen. In general, we did not have an improvement by combining the demographic information with deep features. However, the performance of logistic regression algorithm with Lasso penalty was boosted by that way, as the only one. To see the results of the singular use of demographic information, we also experimented only on these two features with machine learning algorithms. We expect a visible effect of non-image data, if more information from patient such as doctors report, tobacco product use, associated genetic diseases, etc. is used. Moreover, the singular use results of non-image information would be better with more effective and numerically superior features.

During the machine learning experiments, the reason why we applied cross validation on train data and yielding optimized hyper-parameters from these experiments is that to find the most generalized hyper-parameter settings. If the grid search was applied to the experiment including training on train data and testing on test data, the yielding parameters indeed would be only optimized for our test data. This would be enough for this work, if we only cared about the mathematical results and out success. However, we aimed to find more generalized optimal parameters. Thus, we used 10-fold cross validation which means we experimented on 10 different validation sets. Then we tested these hyper-parameters on test data and reported the final results. In addition to that, we also experimented grid search only on the initially determined test set and reported the results. In this way, the comparison on metrics and optimized parameters can be performed between generalized and specific to our test data.

After these experiments, we encountered the benefits of obtaining parameters by using grid search on train set. We have seen that the parameters in this way are not always the best parameters for our test set. Thanks to this way, we provided the method for how to obtain results not specific to a group of data but more suitable for random grouped data.

Another main comparison was about the effect of regularization on machine learning algorithms. We wanted to see the performance of Lasso and Ridge, and obtained an improvement on linear discriminant analysis with Lasso.

The final best results are as follows:
\begin{itemize}
    \item \textbf{CNN:} The best result was obtained from ResNet-50 model after 9th train epoch in 7 minutes with the accuracy, sensitivity, specificity, precision, F1 score, and AUC score of 92.16\%, 0.9216, 0.9215, 0.9216, 0.9216, 0.9215 respectively, and the loss of 9th train epoch and validation were 0.0223 and 1.3687, respectively.
    \item \textbf{ML:} since the best model on CNN experiments was ResNet-50 model, the feature matrices of deep features providing the best results were also the ones transferred from ResNet-50 model. The results for three feature matrices $X_{info}$, $X_{cnn\_ResNet50}$ and $X_{all\_ResNet50}$ are as follows:
    \begin{itemize}
        \item the best result obtained from demographic information features was on KNN algorithm as the accuracy of 56.86\%, the sensitivity of 0.56863, the specificity of 0.58368 the precision of 0.6863, the F1 score of 0.49545, and the AUC score of 0.5745. The hyper-parameters were the number of neighbors as 17, the type of majority voting as uniform, the neighbor finder as brute force, and the metric function as euclidean,
        \item the best result obtained from deep transferred features was not singular. According the generalized hyper-parameters, SVM with Ridge regularizer, LR, LR with Ridge, and KNN algorithms had the same results with the accuracy, sensitivity, specificity, precision, F1 score and AUC score of 92.16\%, 0.9216, 0.9230, 0.9243, 0.9215, 0.9223 respectively, and
        \item the best result obtained from the combined features of demographic information and deep features was not singular. According the generalized hyper-parameters, SVM with Ridge regularizer, LR, LR with Ridge, and KNN algorithms had the same results with the accuracy, sensitivity, specificity, precision, F1 score and AUC score of 92.16\%, 0.9216, 0.9230, 0.9243, 0.9215, 0.9223 respectively.
    \end{itemize}
\end{itemize}

As it can be seen on confusion matrices of convolutional neural network results and machine learning results, the performance of classification for non-COVID labeled data was improved by machine learning algorithms. Moreover, the sensitivity, specificity, precision and F1 score was 0.9216, 0.9215, 0.9216 and 0.9216 respectively for ResNet-50 model, the result for machine learning algorithms was 0.9216, 0.9230, 0.9242, and 0.9216 for the sensitivity, specificity, precision and F1 score respectively. Briefly, even though the accuracy, sensitivity and F1 score did not improve, the specificity and precision improved. This can be interpreted as the answers of two questions could be given better: 1) how many of data estimated as infected were actually infected, and 2) how many of non-COVID-19 data over all patients correctly predicted.


We recommend that the chest X-ray images to be used be reviewed and, if necessary, eliminated by experts. In studies similar to ours, getting support from expert radiologists ensures that better quality images are obtained. In this way, more successful models can be obtained.

After constructing our data set, which has two classes such that COVID-19 and non-COVID-19, including samples with demographic information, the deep learning experiments were done to obtain the features of images. Then, this features called as deep features are used to feed machine learning algorithms to complete the experiments of our study.

\section{Future Work}

Although this thesis focuses on chest X-Rays images, any other image classification problem can be studied as a future work. If the study data set consisting of images also includes non-image information, this thesis can be used as a guide for corresponding classification problem.

This study can also be applied to multi-class classification problems on various respiratory diseases diagnosed by chest computed tomography images of patients where in addition to the demographic information such as age, gender, and tobacco product use, clinical information such as doctors report,  associated genetic diseases, and respiratory test information are available as well. We also recommend getting advise from radiologists and chest disease specialists on the data, for the given study example.

This study can be improved by using large data in size and can be extended by using chest computer tomography along with more various information obtained from the patients. On the other hand, different optimizers such as Adagrad \cite{adagrad} and Padam \cite{padam} for convolutional neural networks and elastic net regularization method \cite{elasticnet_paper} for machine learning algorithms can be used to extend this study. Moreover, ensemble learning \cite{ensemble_learning} for convolutional neural network process and machine learning process can be separately used to extend the scope and results of this study.